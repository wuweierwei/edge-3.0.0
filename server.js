/*! ander <anderpang@qq.com> 2016/3/17 */
"use strict";var path=require("path"),spawn=require("child_process").spawn,child;function _start(){child=spawn("node",[path.join(__dirname,"lib","client.js")]);child.stdout.setEncoding("utf8");child.stderr.setEncoding("utf8");child.stdout.on("data",function(a){console.log(a)});child.stderr.on("data",function(a){if(a.indexOf("FSEvent.FSWatcher._handle.onchange")===-1){console.log("\x1b[31mERROR\x1b[0m:\n"+a)}this.emit("exit",99)});child.on("exit",function(a,b){if(a===99||a===1){clearClient();process.nextTick(_start);console.log("\x1b[44m Ready to restart... \x1b[0m ")}else{console.log("\x1b[44m Server was closed! \x1b[0m")}})}function clearClient(){child.kill()}function start(){_start();process.on("uncaughtException",function(a){console.log("\x1b[31Main process\x1b[0m:\n",a);clearClient()})}start();